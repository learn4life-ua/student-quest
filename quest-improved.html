<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–û–Ω–ª–∞–π–Ω-–∫–≤–µ—Å—Ç: –ê–∫–∞–¥–µ–º—ñ—á–Ω–∞ –¥–æ–±—Ä–æ—á–µ—Å–Ω—ñ—Å—Ç—å</title>
  <style>
    :root {
      --bg: #f8fafc;        /* slate-50 */
      --text: #334155;      /* slate-700 */
      --muted: #475569;     /* slate-600 */
      --card: #ffffff;      /* white */
      --border: #e2e8f0;    /* slate-200 */
      --brand: #235787;     /* deep blue */
      --accent: #ae2220;    /* red */
      --good: #22c55e;      /* green */
      --good-bg: #f0fdf4;  /* green-50 */
      --bad-bg: #fef2f2;    /* red-50 */
      --warn: #f59e0b;      /* amber-500 */
      --warn-bg:#fffbeb;    /* amber-50 */
    }

    /* Dark theme overrides */
    body.dark {
      --bg: #0b1220;
      --text: #cbd5e1;
      --muted:#94a3b8;
      --card:#0f172a;
      --border:#1e29b3;
      --brand:#3b82f6;
      --accent:#ef4444;
      --good:#22c55e;
      --good-bg:#052e1a;
      --bad-bg:#2a0c0c;
      --warn:#f59e0b;
      --warn-bg:#2a1b06;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
      'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif;
      background: var(--bg); color: var(--text); line-height: 1.6;
      transition: background-color 0.3s, color .3s;
    }
    .container { max-width: 980px; margin: 24px auto; padding: 0 16px; }

    .topbar{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:10px}
    .topbar .right{display:flex; align-items:center; gap:10px}

    .progress-container { width: 100%; background: var(--border); border-radius: 12px; box-shadow: inset 0 1px 3px rgba(0,0,0,.08); }
    .progress-wrap{display:flex; align-items:center; gap:10px; margin-bottom: 14px;}
    .progress-bar { width: 0%; height: 28px; border-radius: 12px; color: #fff; font-weight: 700; background: linear-gradient(45deg, var(--brand), #1a4365); text-align: center; line-height: 28px; transition: width .4s ease; white-space: nowrap; overflow: hidden; }
    body.dark .progress-bar{ background: linear-gradient(45deg, var(--brand), #1e40af); }
    .time-pill{min-width:92px; text-align:center; padding:6px 10px; border:1px solid var(--border); border-radius:999px; font-weight:700;}

    .task-block { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 28px 32px; margin: 18px 0; box-shadow: 0 6px 18px rgba(0,0,0,.06); transition: transform 0.3s, box-shadow 0.3s; }
    .task-block h1, .task-block h2 { color: var(--brand); text-align: center; margin: 0 0 12px; }
    .task-block p { color: var(--muted); margin: 8px 0; }
    .task-block .question-text { font-weight: 700; text-align: center; font-size: 1.2rem; margin: 16px 0 24px; color: var(--text); display: flex; align-items: center; justify-content: center; gap: 10px; }

    .choices-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px,1fr)); gap: 16px; }
    .choice-card { background: var(--bg); border: 2px solid var(--border); border-radius: 12px; padding: 16px; cursor: pointer; text-align: center; font-weight: 700; min-height: 88px; display: flex; align-items: center; justify-content: center; transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease; }
    .choice-card:hover { transform: translateY(-3px); border-color: var(--brand); box-shadow: 0 10px 22px rgba(0,0,0,.08); }
    .choice-card.selected.correct { border-color: var(--good); background-color: var(--good-bg); }
    .choice-card.selected.incorrect { border-color: var(--accent); background-color: var(--bad-bg); cursor: not-allowed; }

    .center { text-align: center; }
    .btn { background: var(--brand); color:#fff; border:0; border-radius:10px; padding: 10px 16px; font-weight: 700; cursor: pointer; transition: transform .15s ease, background .2s ease; display:inline-block; }
    .btn:hover { background: #1a4365; transform: translateY(-2px); }
    body.dark .btn:hover { background: #60a5fa; }
    .btn.accent { background-color: var(--accent); }
    .btn.accent:hover { background-color: #8e1c1a; }
    body.dark .btn.accent:hover { background-color: #b91c1c; }
    .btn.ghost{background:transparent; color: var(--text); border:1px solid var(--border)}

    .muted { font-size: .95rem; color: var(--muted); }

    /* modal */
    .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,.55); display:none; place-items:center; z-index: 1000; padding: 16px; backdrop-filter: blur(4px); }
    .modal { background:var(--card); border:1px solid var(--border); border-radius:16px; padding: 28px; width: min(520px, 96vw); box-shadow: 0 10px 30px rgba(0,0,0,.2); text-align:center; }
    .modal .icon { font-size: 56px; }
    .icon.good { color: var(--good); } .icon.bad { color: var(--accent); }
    .modal textarea { width: 100%; min-height: 120px; margin-top: 12px; padding: 8px; border-radius: 8px; border: 1px solid var(--border); background-color: var(--bg); color: var(--text); font-family: monospace; }

    /* summary */
    .score-circle { width: 120px; height: 120px; border-radius: 50%; background: var(--good-bg); color: var(--good); display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 12px auto; font-size: 2rem; font-weight: bold; border: 4px solid var(--good); }
    .score-circle.medium { background: var(--warn-bg); color: var(--warn); border-color: var(--warn); }
    .score-circle.low { background: var(--bad-bg); color: var(--accent); border-color: var(--accent); }
    .summary-table{ width:100%; border-collapse: collapse; margin-top: 12px; }
    .summary-table th, .summary-table td{ border:1px solid var(--border); padding:8px 10px; text-align:left; }
    .summary-table th{ background: var(--bg); }
    .summary-table td:nth-child(4) { text-align: center; }

  </style>
</head>
<body>
  <div class="container">
    <div class="topbar">
      <div class="left muted">–¢–µ–º–∞: –ê–∫–∞–¥–µ–º—ñ—á–Ω–∞ –¥–æ–±—Ä–æ—á–µ—Å–Ω—ñ—Å—Ç—å</div>
      <div class="right">
        <span class="time-pill" id="timePill">00:00</span>
        <button class="btn ghost" id="themeBtn">üåô –ù—ñ—á–Ω–∞ —Ç–µ–º–∞</button>
      </div>
    </div>

    <!-- –ü–†–û–ì–†–ï–° -->
    <div class="progress-wrap">
      <div class="progress-container" aria-hidden="true" style="flex:1"><div class="progress-bar" id="progressBar">–ì–æ—Ç–æ–≤–æ: 0%</div></div>
    </div>

    <!-- –í–°–¢–£–ü -->
    <section class="task-block" id="intro">
      <h1>üéì –û–Ω–ª–∞–π–Ω-–∫–≤–µ—Å—Ç: –ê–∫–∞–¥–µ–º—ñ—á–Ω–∞ –¥–æ–±—Ä–æ—á–µ—Å–Ω—ñ—Å—Ç—å</h1>
      <p class="center">–í—ñ—Ç–∞—î–º–æ! –ù–∞ –≤–∞—Å —á–µ–∫–∞—î 5 —Å—Ç–∞–Ω—Ü—ñ–π-–≤–∏–ø—Ä–æ–±—É–≤–∞–Ω—å. –û–±–µ—Ä—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç, —â–æ–± –ø–µ—Ä–µ–π—Ç–∏ –¥–∞–ª—ñ. –ù–∞–ø—Ä–∏–∫—ñ–Ω—Ü—ñ –æ—Ç—Ä–∏–º–∞—î—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ñ –∑–º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ø–æ—Ä–∞–¥–∏.</p>
      <div class="center" style="margin-top:12px">
        <button class="btn accent" id="startBtn">–ü–æ—á–∞—Ç–∏ –∫–≤–µ—Å—Ç</button>
      </div>
      <p class="center muted" style="margin-top:10px">–û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞. –ß–∞—Å –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –±—É–¥–µ –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ.</p>
    </section>

    <!-- Q1 -->
    <section class="task-block" id="q1" hidden>
      <h2>–°—Ç–∞–Ω—Ü—ñ—è 1</h2>
      <p class="question-text">üìñ –©–æ –Ω–∞–π—Ç–æ—á–Ω—ñ—à–µ –æ–ø–∏—Å—É—î <em>–∞–∫–∞–¥–µ–º—ñ—á–Ω—É –¥–æ–±—Ä–æ—á–µ—Å–Ω—ñ—Å—Ç—å</em>?</p>
      <div class="choices-container">
        <div class="choice-card" data-correct="false" data-choice="1">–ó–¥–∞—Ç–Ω—ñ—Å—Ç—å –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –±—É–¥—å-—è–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º</div>
        <div class="choice-card" data-correct="true" data-choice="2">–ß–µ—Å–Ω–µ –π —Å–∞–º–æ—Å—Ç—ñ–π–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è –∑ –∫–æ—Ä–µ–∫—Ç–Ω–∏–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –¥–∂–µ—Ä–µ–ª</div>
        <div class="choice-card" data-correct="false" data-choice="3">–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –¥—Ä—É–∫–æ–≤–∞–Ω–∏—Ö –∫–Ω–∏–∂–æ–∫</div>
        <div class="choice-card" data-correct="false" data-choice="4">–î–æ–∑–≤–æ–ª–µ–Ω–µ —Å–ø–∏—Å—É–≤–∞–Ω–Ω—è –∑–∞ –∑–≥–æ–¥–æ—é –æ–¥–Ω–æ–≥—Ä—É–ø–Ω–∏–∫–∞</div>
      </div>
    </section>

    <!-- Q2 -->
    <section class="task-block" id="q2" hidden>
      <h2>–°—Ç–∞–Ω—Ü—ñ—è 2</h2>
      <p class="question-text">üîç –©–æ —Ç–∞–∫–µ –ø–ª–∞–≥—ñ–∞—Ç —É —Å—Ç—É–¥–µ–Ω—Ç—Å—å–∫–∏—Ö —Ä–æ–±–æ—Ç–∞—Ö?</p>
      <div class="choices-container">
        <div class="choice-card" data-correct="false" data-choice="1">–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ª–∏—à–µ –ø—ñ–¥—Ä—É—á–Ω–∏–∫–∞ –∑–∞–º—ñ—Å—Ç—å —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-–¥–∂–µ—Ä–µ–ª</div>
        <div class="choice-card" data-correct="true" data-choice="2">–ü—Ä–∏–≤–ª–∞—Å–Ω–µ–Ω–Ω—è —á—É–∂–æ–≥–æ —Ç–µ–∫—Å—Ç—É/—ñ–¥–µ—ó –±–µ–∑ –∑–∞–∑–Ω–∞—á–µ–Ω–Ω—è –∞–≤—Ç–æ—Ä–∞</div>
        <div class="choice-card" data-correct="false" data-choice="3">–¶–∏—Ç—É–≤–∞–Ω–Ω—è –∑ –ª–∞–ø–∫–∞–º–∏ —ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º</div>
        <div class="choice-card" data-correct="false" data-choice="4">–ü–µ—Ä–µ–∫–ª–∞–¥ —Ç–µ–∫—Å—Ç—É –±–µ–∑ –∑–º—ñ–Ω –º–æ–≤–∏</div>
      </div>
    </section>

    <!-- Q3 -->
    <section class="task-block" id="q3" hidden>
      <h2>–°—Ç–∞–Ω—Ü—ñ—è 3</h2>
      <p class="question-text">‚úçÔ∏è –í–∏ –ø–µ—Ä–µ—Ñ—Ä–∞–∑—É–≤–∞–ª–∏ –∞–±–∑–∞—Ü –∑—ñ —Å—Ç–∞—Ç—Ç—ñ —Å–≤–æ—ó–º–∏ —Å–ª–æ–≤–∞–º–∏. –ß–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –¥–∂–µ—Ä–µ–ª–æ?</p>
      <div class="choices-container">
        <div class="choice-card" data-correct="true" data-choice="1">–¢–∞–∫, –±–æ —ñ–¥–µ—è –Ω–∞–ª–µ–∂–∏—Ç—å –∞–≤—Ç–æ—Ä—É, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ç–µ–∫—Å—Ç –ø–µ—Ä–µ—Ñ—Ä–∞–∑–æ–≤–∞–Ω–æ</div>
        <div class="choice-card" data-correct="false" data-choice="2">–ù—ñ, –ø–æ—Å–∏–ª–∞–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–µ —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ –¥–æ—Å–ª—ñ–≤–Ω—ñ–π —Ü–∏—Ç–∞—Ç—ñ</div>
        <div class="choice-card" data-correct="false" data-choice="3">–õ–∏—à–µ —è–∫—â–æ –¥–∂–µ—Ä–µ–ª–æ ‚Äî –Ω–µ –∑ –í—ñ–∫—ñ–ø–µ–¥—ñ—ó</div>
        <div class="choice-card" data-correct="false" data-choice="4">–õ–∏—à–µ —è–∫—â–æ —Ü—å–æ–≥–æ –ø–æ–ø—Ä–æ—Å–∏–≤ –≤–∏–∫–ª–∞–¥–∞—á</div>
      </div>
    </section>

    <!-- Q4 -->
    <section class="task-block" id="q4" hidden>
      <h2>–°—Ç–∞–Ω—Ü—ñ—è 4</h2>
      <p class="question-text">ü§ñ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –®–Ü –≤ –Ω–∞–≤—á–∞–Ω–Ω—ñ ‚Äî —è–∫–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –∫–æ—Ä–µ–∫—Ç–Ω–∏–π?</p>
      <div class="choices-container">
        <div class="choice-card" data-correct="false" data-choice="1">–ù–∞–¥–∞–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –≤—ñ–¥ –®–Ü –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ñ–∞–∫—Ç—ñ–≤</div>
        <div class="choice-card" data-correct="true" data-choice="2">–ó–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –®–Ü —è–∫ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —Ñ–∞–∫—Ç–∏ –π –∑–∞–∑–Ω–∞—á–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è</div>
        <div class="choice-card" data-correct="false" data-choice="3">–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –®–Ü –ª–∏—à–µ –¥–ª—è –ø–µ—Ä–µ–∫–ª–∞–¥—É —Ç–µ–∫—Å—Ç—ñ–≤ ‚Äî —Ç–æ–¥—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–µ</div>
        <div class="choice-card" data-correct="false" data-choice="4">–ü—Ä–∏—Ö–æ–≤—É–≤–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –®–Ü, –∞–±–∏ –Ω–µ –∑–Ω–∏–∂—É–≤–∞–ª–∏ –±–∞–ª</div>
      </div>
    </section>

    <!-- Q5 -->
    <section class="task-block" id="q5" hidden>
      <h2>–°—Ç–∞–Ω—Ü—ñ—è 5</h2>
      <p class="question-text">ü§ù –ö–µ–π—Å: –æ–¥–Ω–æ–≥—Ä—É–ø–Ω–∏–∫ –ø—Ä–æ—Å–∏—Ç—å ¬´–ø–µ—Ä–µ–∫–∏–Ω—É—Ç–∏¬ª –≥–æ—Ç–æ–≤—É –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É. –Ø–∫ –¥—ñ—è—Ç–∏?</p>
      <div class="choices-container">
        <div class="choice-card" data-correct="true" data-choice="1">–í—ñ–¥–º–æ–≤–∏—Ç–∏, –ø–æ—è—Å–Ω–∏—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –¥–æ–±—Ä–æ—á–µ—Å–Ω–æ—Å—Ç—ñ —Ç–∞ –∑–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ –¥–æ–ø–æ–º–æ–≥—É –≤ –ø—ñ–¥–≥–æ—Ç–æ–≤—Ü—ñ</div>
        <div class="choice-card" data-correct="false" data-choice="2">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ —Ñ–∞–π–ª, –∞–ª–µ –ø–æ–ø—Ä–æ—Å–∏—Ç–∏ –Ω–µ –∫–æ–ø—ñ—é–≤–∞—Ç–∏ –¥–æ—Å–ª—ñ–≤–Ω–æ</div>
        <div class="choice-card" data-correct="false" data-choice="3">–í–∏–∫–ª–∞—Å—Ç–∏ —Ä–æ–±–æ—Ç—É —É —Å–ø—ñ–ª—å–Ω–∏–π —á–∞—Ç –¥–ª—è –≤—Å—ñ—Ö</div>
        <div class="choice-card" data-correct="false" data-choice="4">–ü–æ–º—ñ–Ω—è—Ç–∏—Å—è —Ä–æ–±–æ—Ç–∞–º–∏ ‚Äî —Å—å–æ–≥–æ–¥–Ω—ñ —Ç–≤–æ—è, –∑–∞–≤—Ç—Ä–∞ –º–æ—è</div>
      </div>
    </section>

    <!-- SUMMARY -->
    <section class="task-block" id="summary" hidden>
      <h1>üéâ –ö–≤–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</h1>
      <div id="scoreCircle" class="score-circle">5/5</div>
      <p id="scoreLine" class="center" style="font-weight:700; font-size: 1.2rem;">–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á—É–¥–æ–≤–∏–π!</p>
      <p class="center muted" id="timeLine">–ß–∞—Å –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è: 00:00</p>

      <table class="summary-table" id="reviewTable">
        <thead>
          <tr><th>‚Ññ</th><th>–°—Ç–∞—Ç—É—Å</th><th>–í–∞—à –≤–∏–±—ñ—Ä</th><th>–°–ø—Ä–æ–±</th><th>–ö–æ–º–µ–Ω—Ç–∞—Ä</th></tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="center" style="margin-top:12px; display:flex; gap:8px; justify-content:center; flex-wrap:wrap">
        <button class="btn" id="copyBtn">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
        <button class="btn ghost" id="shareBtn">–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è‚Ä¶</button>
        <button class="btn accent" id="restartBtn">–ü—Ä–æ–π—Ç–∏ —â–µ —Ä–∞–∑</button>
      </div>
    </section>
  </div>

  <!-- MODAL -->
  <div class="modal-overlay" id="modal">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalText">
      <div id="modalIcon" class="icon" aria-hidden="true">‚úÖ</div>
      <h3 id="modalTitle">–í—ñ—Ä–Ω–æ!</h3>
      <p id="modalText">–ì–∞—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞.</p>
      <button class="btn" id="modalBtn">–î–∞–ª—ñ ‚Üí</button>
    </div>
  </div>
  
  <!-- Copy/Share Modal -->
  <div class="modal-overlay" id="copyModal">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="copyModalTitle">
       <h3 id="copyModalTitle">–°–∫–æ–ø—ñ—é–π—Ç–µ –≤–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h3>
       <p>–ë—É–¥—å –ª–∞—Å–∫–∞, —Å–∫–æ–ø—ñ—é–π—Ç–µ —Ç–µ–∫—Å—Ç –Ω–∏–∂—á–µ –≤—Ä—É—á–Ω—É (Ctrl+C –∞–±–æ Cmd+C).</p>
       <textarea id="copyModalTextarea" readonly></textarea>
       <button class="btn" id="copyModalCloseBtn" style="margin-top: 12px;">–ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>
  </div>

  <script>
    (function(){
      const total = 5;
      let current = 0; // 1..5
      let score = 0;
      let questionAnswered = false; // –±–ª–æ–∫—É—î –ø–æ–≤—Ç–æ—Ä–Ω—ñ –∫–ª—ñ–∫–∏
      let startTs = null; let timerId = null; let elapsed = 0; // —Å–µ–∫

      let attempts = [1, 1, 1, 1, 1, 1]; // [0] unused

      const progressBar = document.getElementById('progressBar');
      const modal = document.getElementById('modal');
      const modalIcon = document.getElementById('modalIcon');
      const modalTitle = document.getElementById('modalTitle');
      const modalText  = document.getElementById('modalText');
      const modalBtn   = document.getElementById('modalBtn');
      const timePill = document.getElementById('timePill');

      const copyModal = document.getElementById('copyModal');
      const copyModalTextarea = document.getElementById('copyModalTextarea');
      const copyModalCloseBtn = document.getElementById('copyModalCloseBtn');

      const sections = ['intro','q1','q2','q3','q4','q5','summary'];

      const answers = [null, null, null, null, null, null]; // 1..5 -> {choiceText, correct, comment, attempts}

      const feedback = {
        q1: {
          good: { title: '–ß—É–¥–æ–≤–æ!', text: '–î–æ–±—Ä–æ—á–µ—Å–Ω—ñ—Å—Ç—å = —á–µ—Å–Ω—ñ—Å—Ç—å, —Å–∞–º–æ—Å—Ç—ñ–π–Ω—ñ—Å—Ç—å —ñ –ø–æ–≤–∞–≥–∞ –¥–æ –∞–≤—Ç–æ—Ä—Å—Ç–≤–∞.' },
          bad: {
            '1': { title: '–ù–µ –∑–æ–≤—Å—ñ–º —Ç–∞–∫', text: '–ê–∫–∞–¥–µ–º—ñ—á–Ω–∞ –¥–æ–±—Ä–æ—á–µ—Å–Ω—ñ—Å—Ç—å ‚Äî —Ü–µ –ø—Ä–æ –µ—Ç–∏—á–Ω—ñ –º–µ—Ç–æ–¥–∏, –∞ –Ω–µ –ø—Ä–æ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –º–µ—Ç–∏ –±—É–¥—å-—è–∫–æ—é —Ü—ñ–Ω–æ—é.' },
            '3': { title: '–ó–∞–Ω–∞–¥—Ç–æ –≤—É–∑—å–∫–æ', text: '–î–æ–±—Ä–æ—á–µ—Å–Ω—ñ—Å—Ç—å –Ω–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ñ–æ—Ä–º–∞—Ç—É –¥–∂–µ—Ä–µ–ª–∞ (–¥—Ä—É–∫–æ–≤–∞–Ω–µ —á–∏ –æ–Ω–ª–∞–π–Ω). –ì–æ–ª–æ–≤–Ω–µ ‚Äî –∫–æ—Ä–µ–∫—Ç–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è.' },
            '4': { title: '–¶–µ –ø–æ—Ä—É—à–µ–Ω–Ω—è', text: '–°–ø–∏—Å—É–≤–∞–Ω–Ω—è, –Ω–∞–≤—ñ—Ç—å –∑–∞ –∑–≥–æ–¥–æ—é, —î —Ñ–æ—Ä–º–æ—é –æ–±–º–∞–Ω—É —Ç–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è–º –∞–∫–∞–¥–µ–º—ñ—á–Ω–∏—Ö –ø—Ä–∞–≤–∏–ª.' }
          }
        },
        q2: {
          good: { title: '–í—ñ—Ä–Ω–æ!', text: '–ü–ª–∞–≥—ñ–∞—Ç ‚Äî —Ü–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —á—É–∂–∏—Ö —ñ–¥–µ–π/—Ç–µ–∫—Å—Ç—ñ–≤ –±–µ–∑ –Ω–∞–ª–µ–∂–Ω–æ–≥–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è.' },
          bad: {
            '1': { title: '–°–ø—Ä–∞–≤–∞ –Ω–µ –≤ –¥–∂–µ—Ä–µ–ª—ñ', text: '–ü–ª–∞–≥—ñ–∞—Ç –º–æ–∂–ª–∏–≤–∏–π —è–∫ –∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-–¥–∂–µ—Ä–µ–ª, —Ç–∞–∫ —ñ –∑ –ø—ñ–¥—Ä—É—á–Ω–∏–∫—ñ–≤. –í–∞–∂–ª–∏–≤–æ –Ω–µ –¥–∂–µ—Ä–µ–ª–æ, –∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –Ω—å–æ–≥–æ.' },
            '3': { title: '–ù–∞–≤–ø–∞–∫–∏!', text: '–ü—Ä–∞–≤–∏–ª—å–Ω–µ —Ü–∏—Ç—É–≤–∞–Ω–Ω—è (–∑ –ª–∞–ø–∫–∞–º–∏ —Ç–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º) ‚Äî —Ü–µ —è–∫—Ä–∞–∑ —Å–ø–æ—Å—ñ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø–ª–∞–≥—ñ–∞—Ç—É.' },
            '4': { title: '–¶–µ —Ç–µ–∂ –º–æ–∂–µ –±—É—Ç–∏ –ø–ª–∞–≥—ñ–∞—Ç', text: '–ü—Ä–∏–≤–ª–∞—Å–Ω–µ–Ω–Ω—è —á—É–∂–æ–≥–æ –ø–µ—Ä–µ–∫–ª–∞–¥—É –∞–±–æ –ø–µ—Ä–µ–∫–ª–∞–¥ –±–µ–∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –æ—Ä–∏–≥—ñ–Ω–∞–ª —î —Ä—ñ–∑–Ω–æ–≤–∏–¥–∞–º–∏ –ø–ª–∞–≥—ñ–∞—Ç—É.' }
          }
        },
        q3: {
          good: { title: '–°–∞–º–µ —Ç–∞–∫!', text: '–ù–∞–≤—ñ—Ç—å –ø–µ—Ä–µ—Ñ—Ä–∞–∑–æ–≤—É—é—á–∏, –º–∏ –∑–æ–±–æ–≤‚Äô—è–∑–∞–Ω—ñ –ø–æ—Å–∏–ª–∞—Ç–∏—Å—è –Ω–∞ –∞–≤—Ç–æ—Ä–∞ —ñ–¥–µ—ó.' },
          bad: {
            '2': { title: '–ù–µ —Ç—ñ–ª—å–∫–∏', text: '–ü–æ—Å–∏–ª–∞–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–µ –∑–∞–≤–∂–¥–∏, –∫–æ–ª–∏ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ —á—É–∂—É —ñ–¥–µ—é, –∞ –Ω–µ –ª–∏—à–µ –¥–æ—Å–ª—ñ–≤–Ω—É —Ü–∏—Ç–∞—Ç—É.' },
            '3': { title: '–ë—É–¥—å-—è–∫–µ –¥–∂–µ—Ä–µ–ª–æ', text: '–ù–∞ –≤—Å—ñ –¥–∂–µ—Ä–µ–ª–∞, –≤–∫–ª—é—á–Ω–æ –∑ –í—ñ–∫—ñ–ø–µ–¥—ñ—î—é, –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–±–∏—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è, —è–∫—â–æ –≤–∏ –±–µ—Ä–µ—Ç–µ –∑–≤—ñ–¥—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.' },
            '4': { title: '–¶–µ –±–∞–∑–æ–≤–µ –ø—Ä–∞–≤–∏–ª–æ', text: '–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –¥–∂–µ—Ä–µ–ª–∞ —î –æ–±–æ–≤\'—è–∑–∫–æ–≤–æ—é –≤–∏–º–æ–≥–æ—é, –∞ –Ω–µ –æ—Å–æ–±–∏—Å—Ç–∏–º –ø—Ä–æ—Ö–∞–Ω–Ω—è–º –≤–∏–∫–ª–∞–¥–∞—á–∞.' }
          }
        },
        q4: {
          good: { title: '–ü—Ä–∞–≤–∏–ª—å–Ω–æ!', text: '–®–Ü ‚Äî —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç. –ö–æ—Ä–∏—Å—Ç—É—î–º–æ—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ: –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Ñ–∞–∫—Ç–∏ –π –∑–∞–∑–Ω–∞—á–∞—î–º–æ.' },
          bad: {
            '1': { title: '–í–µ–ª–∏–∫–∞ –ø–æ–º–∏–ª–∫–∞', text: '–®–Ü –º–æ–∂–µ –ø–æ–º–∏–ª—è—Ç–∏—Å—è. –í–∏ –Ω–µ—Å–µ—Ç–µ –ø–æ–≤–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å –∑–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —É –≤–∞—à—ñ–π —Ä–æ–±–æ—Ç—ñ.' },
            '3': { title: '–¶–µ —Ç–µ–∂ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è', text: '–Ø–∫—â–æ –®–Ü –¥–æ–ø–æ–º—ñ–≥ –≤–∞–º —É —Ä–æ–±–æ—Ç—ñ (–Ω–∞–≤—ñ—Ç—å –∑ –ø–µ—Ä–µ–∫–ª–∞–¥–æ–º), —Ü–µ –≤–∞—Ä—Ç–æ —á–µ—Å–Ω–æ –≤–∫–∞–∑–∞—Ç–∏.' },
            '4': { title: '–¶–µ –Ω–µ—á–µ—Å–Ω–æ', text: '–ü—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–æ–ø–æ–º—ñ–∂–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —î –ø–æ—Ä—É—à–µ–Ω–Ω—è–º –∞–∫–∞–¥–µ–º—ñ—á–Ω–æ—ó –¥–æ–±—Ä–æ—á–µ—Å–Ω–æ—Å—Ç—ñ.' }
          }
        },
        q5: {
          good: { title: '–ú—É–¥—Ä–µ —Ä—ñ—à–µ–Ω–Ω—è!', text: '–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ ‚Äî —Ü–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –ø—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏—Å—å, –∞ –Ω–µ –¥—ñ–ª–∏—Ç–∏—Å—è –≥–æ—Ç–æ–≤–æ—é —Ä–æ–±–æ—Ç–æ—é.' },
          bad: {
            '2': { title: '–¶–µ —Å–ø—ñ–≤—É—á–∞—Å—Ç—å', text: '–ù–∞–≤—ñ—Ç—å —è–∫—â–æ –¥—Ä—É–≥ –ø–µ—Ä–µ—Ñ—Ä–∞–∑—É—î, –≤–∏ –≤—Å–µ –æ–¥–Ω–æ —Å–ø—Ä–∏—è—î—Ç–µ –Ω–µ—Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ–º—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—é —Ä–æ–±–æ—Ç–∏.' },
            '3': { title: '–ü–æ–≥–∞–Ω–∞ —ñ–¥–µ—è', text: '–ú–∞—Å–æ–≤–µ –ø–æ—à–∏—Ä–µ–Ω–Ω—è –≥–æ—Ç–æ–≤–∏—Ö —Ä–æ–±—ñ—Ç –ª–∏—à–µ –ø–æ–≥—ñ—Ä—à—É—î —Å–∏—Ç—É–∞—Ü—ñ—é —Ç–∞ –∑–Ω–µ—Ü—ñ–Ω—é—î –Ω–∞–≤—á–∞–Ω–Ω—è.' },
            '4': { title: '–¶–µ –∑–º–æ–≤–∞', text: '–¢–∞–∫–∞ "–≤–∑–∞—î–º–æ–¥–æ–ø–æ–º–æ–≥–∞" —î —Ñ–æ—Ä–º–æ—é —à–∞—Ö—Ä–∞–π—Å—Ç–≤–∞ —ñ —Å–µ—Ä–π–æ–∑–Ω–∏–º –ø–æ—Ä—É—à–µ–Ω–Ω—è–º –ø—Ä–∞–≤–∏–ª.' }
          }
        }
      };

      let lastAnswerCorrect = false;

      function show(id){
        sections.forEach(s=>{ const node = document.getElementById(s); if(!node) return; if(s===id) node.removeAttribute('hidden'); else node.setAttribute('hidden',''); });
        questionAnswered = false;
        window.scrollTo({top:0, behavior:'smooth'});
      }

      function setProgress(){
        const pct = Math.round((Math.max(0, current - 1) / total) * 100);
        progressBar.style.width = pct + '%';
        progressBar.textContent = `–ì–æ—Ç–æ–≤–æ: ${pct}%`;
      }

      function fmtTime(sec){ const m = String(Math.floor(sec/60)).padStart(2,'0'); const s = String(sec%60).padStart(2,'0'); return `${m}:${s}`; }

      function startTimer(){
        startTs = Date.now();
        if(timerId) clearInterval(timerId);
        timerId = setInterval(()=>{ elapsed = Math.floor((Date.now()-startTs)/1000); timePill.textContent = fmtTime(elapsed); }, 500);
      }
      function stopTimer(){ if(timerId) clearInterval(timerId); timerId=null; }

      function openModal(ok, choiceId, chosenText){
        lastAnswerCorrect = ok;
        const key = 'q'+current;
        const f = ok ? feedback[key].good : feedback[key].bad[choiceId];

        answers[current] = { 
          choiceText: chosenText, 
          correct: ok, 
          comment: f.text,
          attempts: attempts[current]
        };

        if(ok) score++;
        
        modalIcon.textContent = ok ? '‚úÖ' : '‚ùå';
        modalIcon.className = ok ? 'icon good' : 'icon bad';
        modalTitle.textContent = f.title;
        modalText.textContent  = f.text;
        modalBtn.textContent = ok ? '–î–∞–ª—ñ ‚Üí' : '–ó—Ä–æ–∑—É–º—ñ–ª–æ';
        modalBtn.className = ok ? 'btn' : 'btn accent';
        modal.style.display = 'grid';
      }

      function closeModal(){ modal.style.display = 'none'; }
      function openCopyModal(text) {
        copyModalTextarea.value = text;
        copyModal.style.display = 'grid';
        copyModalTextarea.select();
        copyModalTextarea.setSelectionRange(0, 99999); // For mobile devices
      }
      function closeCopyModal() { copyModal.style.display = 'none'; }

      function buildSummary(){
        const tbody = document.querySelector('#reviewTable tbody');
        tbody.innerHTML = '';
        for(let i=1; i<=total; i++){
          const a = answers[i];
          const tr = document.createElement('tr');
          
          const tdN = document.createElement('td'); 
          tdN.textContent = i; 
          tr.appendChild(tdN);
          
          const tdS = document.createElement('td'); 
          tdS.textContent = a && a.correct ? '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ' : '‚ùå –ü–æ–º–∏–ª–∫–∞'; 
          tr.appendChild(tdS);
          
          const tdC = document.createElement('td'); 
          tdC.textContent = a ? a.choiceText : '-'; 
          tr.appendChild(tdC);

          const tdA = document.createElement('td');
          tdA.textContent = a && a.correct ? a.attempts : '-';
          tdA.style.textAlign = 'center';
          tr.appendChild(tdA);
          
          const tdM = document.createElement('td'); 
          tdM.textContent = a ? a.comment : '-'; 
          tr.appendChild(tdM);

          tbody.appendChild(tr);
        }
      }

      function showSummary() {
        stopTimer();
        const scoreCircle = document.getElementById('scoreCircle');
        const scoreLine = document.getElementById('scoreLine');
        const timeLine = document.getElementById('timeLine');
        scoreCircle.textContent = `${score}/${total}`;
        timeLine.textContent = `–ß–∞—Å –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è: ${fmtTime(elapsed)}`;
        
        if (score === total) { scoreLine.textContent = '–í—ñ–¥–º—ñ–Ω–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –í–∏ ‚Äî –∑–Ω–∞–≤–µ—Ü—å –¥–æ–±—Ä–æ—á–µ—Å–Ω–æ—Å—Ç—ñ.'; scoreCircle.className = 'score-circle'; }
        else if (score >= total * 0.6) { scoreLine.textContent = '–ì–∞—Ä–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∞–ª–µ —î —â–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏.'; scoreCircle.className = 'score-circle medium'; }
        else { scoreLine.textContent = '–í–∞—Ä—Ç–æ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ —â–µ —Ä–∞–∑.'; scoreCircle.className = 'score-circle low'; }

        buildSummary();
        show('summary');
      }

      // START
      document.getElementById('startBtn').addEventListener('click', ()=>{ 
        current = 1; 
        score = 0; 
        elapsed = 0; 
        attempts = [1, 1, 1, 1, 1, 1];
        timePill.textContent='00:00'; 
        startTimer(); 
        setProgress(); 
        show('q1'); 
      });

      // ANSWERS
      document.querySelectorAll('.choice-card').forEach(card=>{
        card.addEventListener('click', ()=>{
          if(current<1 || current>total || questionAnswered) return;
          
          const ok = card.getAttribute('data-correct') === 'true';
          const choiceId = card.getAttribute('data-choice');
          const chosenText = card.textContent.trim();
          
          if (!ok) {
            attempts[current]++;
          }

          questionAnswered = true;
          card.parentElement.querySelectorAll('.choice-card').forEach(c => c.classList.add('selected'));
          card.classList.add(ok ? 'correct' : 'incorrect');

          setTimeout(() => openModal(ok, choiceId, chosenText), 300);
        });
      });

      // MODAL ACTION
      modalBtn.addEventListener('click', ()=>{
        closeModal();
        if (!lastAnswerCorrect) {
          questionAnswered = false;
          document.querySelectorAll(`#q${current} .choice-card`).forEach(c => { c.classList.remove('selected', 'correct', 'incorrect'); });
          return;
        }
        current++;
        if(current > total){ setProgress(); showSummary(); } else { setProgress(); show('q'+current); }
      });

      // RESTART
      document.getElementById('restartBtn').addEventListener('click', ()=>{ 
        current = 0; 
        score = 0; 
        elapsed = 0; 
        attempts = [1, 1, 1, 1, 1, 1];
        answers.fill(null); 
        timePill.textContent='00:00'; 
        stopTimer(); 
        setProgress(); 
        show('intro'); 
      });

      // THEME TOGGLE
      const themeBtn = document.getElementById('themeBtn');
      function applyTheme(){ const m = localStorage.getItem('theme')||'light'; if(m==='dark') document.body.classList.add('dark'); else document.body.classList.remove('dark'); themeBtn.textContent = document.body.classList.contains('dark') ? '‚òÄÔ∏è –°–≤—ñ—Ç–ª–∞ —Ç–µ–º–∞' : 'üåô –ù—ñ—á–Ω–∞ —Ç–µ–º–∞'; }
      themeBtn.addEventListener('click', ()=>{ const isDark = document.body.classList.toggle('dark'); localStorage.setItem('theme', isDark?'dark':'light'); applyTheme(); });
      
      // SHARE/COPY RESULT
      function buildShareText() {
        const totalAttempts = answers.slice(1).reduce((sum, current) => sum + (current ? current.attempts : 0), 0);
        return `–ö–≤–µ—Å—Ç "–ê–∫–∞–¥–µ–º—ñ—á–Ω–∞ –¥–æ–±—Ä–æ—á–µ—Å–Ω—ñ—Å—Ç—å":\n- –†–µ–∑—É–ª—å—Ç–∞—Ç: ${score}/${total}\n- –ß–∞—Å: ${fmtTime(elapsed)}\n- –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø—Ä–æ–±: ${totalAttempts}`;
      }

      document.getElementById('copyBtn').addEventListener('click', () => {
        openCopyModal(buildShareText());
      });
      
      copyModalCloseBtn.addEventListener('click', closeCopyModal);

      document.getElementById('shareBtn').addEventListener('click', async () => {
        const shareText = buildShareText();
        const shareData = {
            title: '–†–µ–∑—É–ª—å—Ç–∞—Ç –∫–≤–µ—Å—Ç—É: –ê–∫–∞–¥–µ–º—ñ—á–Ω–∞ –¥–æ–±—Ä–æ—á–µ—Å–Ω—ñ—Å—Ç—å',
            text: shareText,
        };

        if (navigator.share) {
            try {
                await navigator.share(shareData);
            } catch (err) {
                if (err.name !== 'AbortError') {
                   openCopyModal(shareText);
                }
            }
        } else {
            openCopyModal(shareText);
        }
      });

      // --- INITIALIZATION ---
      function initApp() {
        applyTheme();
        setProgress();
        // Hide share button if not supported by the browser
        if (!navigator.share) {
          document.getElementById('shareBtn').style.display = 'none';
        }
      }

      initApp();
    })();
  </script>
</body>
</html>

